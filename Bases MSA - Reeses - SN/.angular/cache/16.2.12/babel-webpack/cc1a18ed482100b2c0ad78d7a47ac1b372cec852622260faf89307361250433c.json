{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Mamadou/Documents/GitHub/BroadAppsDeleted/Bases MSA - Reeses/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as ExcelJS from 'exceljs';\nimport { saveAs } from 'file-saver';\nimport * as i0 from \"@angular/core\";\nexport class ExceljsService {\n  constructor() {}\n  createWorkBook(name) {\n    const workbook = new ExcelJS.Workbook();\n    workbook.creator = name;\n    workbook.created = new Date();\n    return workbook;\n  }\n  addWorkSheet(name, workbook) {\n    const sheet = workbook.addWorksheet(name, {\n      pageSetup: {\n        paperSize: 9,\n        orientation: 'landscape'\n      },\n      properties: {\n        tabColor: {\n          argb: 'FF005B0'\n        }\n      }\n    });\n    sheet.state = 'visible';\n    return sheet;\n  }\n  addHeadersToWorkSheet(sheet, headers) {\n    console.log(headers);\n    sheet.addRow(headers.map(headerObj => headerObj.name));\n    const headerRow = sheet.getRow(1);\n    headerRow.font = {\n      bold: true,\n      color: {\n        argb: 'FFFFFF'\n      }\n    }; // Texte en gras et blanc\n    headerRow.fill = {\n      type: 'pattern',\n      pattern: 'solid',\n      fgColor: {\n        argb: '0070C0'\n      }\n    };\n  }\n  addRowToWorkSheet(row, sheet) {\n    console.log(row);\n    sheet.addRow(row);\n  }\n  saveWorkBookIntoFile(wb, name) {\n    return _asyncToGenerator(function* () {\n      let buff = yield wb.xlsx.writeBuffer();\n      const blob = new Blob([buff], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      saveAs(blob, name + \" \" + new Date().toLocaleTimeString('fr-FR', {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric'\n      }));\n    })();\n  }\n  writeAllRowValuesFor1DArray(sheet, values, limit) {\n    let length = 0;\n    console.log(\"limit\" + limit);\n    console.log(\"length\" + length);\n    console.log(\"values\" + values.length);\n    while (length < limit && limit > 0 && values.length >= limit) {\n      let rowOfValues = [];\n      for (let i = 0; i < limit; ++i) {\n        rowOfValues.push(values[i].value);\n        ++length;\n      }\n      console.log(rowOfValues);\n      this.addRowToWorkSheet(rowOfValues, sheet);\n    }\n  }\n  static #_ = this.ɵfac = function ExceljsService_Factory(t) {\n    return new (t || ExceljsService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ExceljsService,\n    factory: ExceljsService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["ExcelJS","saveAs","ExceljsService","constructor","createWorkBook","name","workbook","Workbook","creator","created","Date","addWorkSheet","sheet","addWorksheet","pageSetup","paperSize","orientation","properties","tabColor","argb","state","addHeadersToWorkSheet","headers","console","log","addRow","map","headerObj","headerRow","getRow","font","bold","color","fill","type","pattern","fgColor","addRowToWorkSheet","row","saveWorkBookIntoFile","wb","_asyncToGenerator","buff","xlsx","writeBuffer","blob","Blob","toLocaleTimeString","day","month","year","writeAllRowValuesFor1DArray","values","limit","length","rowOfValues","i","push","value","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Mamadou\\Documents\\GitHub\\BroadAppsDeleted\\Bases MSA - Reeses\\src\\app\\exceljs.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport * as ExcelJS from 'exceljs';\nimport { saveAs } from 'file-saver';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ExceljsService {\n\n  constructor() { }\n  \n  public createWorkBook(name:string):any\n  {\n\t\tconst workbook:any = new ExcelJS.Workbook();\n\t\tworkbook.creator = name;\n\t\tworkbook.created = new Date();\n\t\treturn workbook;\n  }\n  \n  public addWorkSheet(name:string,workbook:any):any\n  {\n\t\tconst sheet:any = workbook.addWorksheet(name,{\n\t\tpageSetup:{paperSize: 9, orientation:'landscape'},properties:{tabColor:{argb:'FF005B0'}}});\n\t\tsheet.state = 'visible';\n\t\treturn sheet;\n  }\n  \n  public addHeadersToWorkSheet(sheet:any,headers:any[])\n  {\n\t\tconsole.log(headers);\n\t\tsheet.addRow(headers.map((headerObj)=> headerObj.name)); \n\t\tconst headerRow = sheet.getRow(1);\n\t\theaderRow.font = { bold: true, color: { argb: 'FFFFFF' } }; // Texte en gras et blanc\n\t\theaderRow.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: '0070C0' } }; \n  }\n  \n  private addRowToWorkSheet(row:any[],sheet:any)\n  {\n\t\tconsole.log(row);\n\t\tsheet.addRow(row); \n  }\n  \n  public async saveWorkBookIntoFile(wb:any,name:string)\n  {\n\tlet buff = await wb.xlsx.writeBuffer();\n\tconst blob = new Blob([buff], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" });\n\tsaveAs(blob,name+\" \"+(new Date()).toLocaleTimeString('fr-FR',{day:'numeric',month:'long',year:'numeric'}));\n  }\n  \n  public writeAllRowValuesFor1DArray(sheet:any,values:any[],limit:number)\n  {\n\t\tlet length = 0;\n\t\tconsole.log(\"limit\"+limit);console.log(\"length\"+length);console.log(\"values\"+values.length);\n\t\twhile(length < limit && limit > 0 && values.length >= limit)\n\t\t{\n\t\t\tlet rowOfValues = [];\n\t\t\tfor(let i = 0; i < limit; ++i)\n\t\t\t{\n\t\t\t\trowOfValues.push(values[i].value);\n\t\t\t\t++length;\n\t\t\t}\n\t\t\tconsole.log(rowOfValues);\n\t\t\tthis.addRowToWorkSheet(rowOfValues,sheet);\n\t\t}\n  }\n  \n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}