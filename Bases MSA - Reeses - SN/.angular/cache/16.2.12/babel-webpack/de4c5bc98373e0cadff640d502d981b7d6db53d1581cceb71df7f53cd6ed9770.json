{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Mamadou/Documents/GitHub/BroadAppsDeleted/Bases MSA - Reeses/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Workbook } from 'exceljs';\nimport { saveAs } from 'file-saver';\nimport * as i0 from \"@angular/core\";\nexport class ExceljsService {\n  constructor() {}\n  createWorkBook(name) {\n    const workbook = new Workbook();\n    workbook.creator = name;\n    workbook.created = new Date();\n    return workbook;\n  }\n  addWorkSheet(name, workbook) {\n    const sheet = workbook.addWorksheet(name, {\n      pageSetup: {\n        paperSize: 9,\n        orientation: 'landscape'\n      },\n      properties: {\n        tabColor: {\n          argb: 'FF005B0'\n        }\n      }\n    });\n    sheet.state = 'visible';\n    return sheet;\n  }\n  addHeadersToWorkSheet(sheet, headers) {\n    console.log(headers);\n    let headersTemp = [];\n    headers.forEach(headerObj => {\n      console.log(headerObj);\n      console.log(typeof headerObj);\n      console.log(typeof headerObj + \" \" + typeof headerObj == 'string');\n      if (typeof headerObj == 'string') {\n        headersTemp.push({\n          header: headerObj,\n          key: headerObj.toLowerCase().replace(' ', ''),\n          width: 15\n        });\n      } else {\n        headersTemp.push({\n          header: headerObj.name,\n          key: headerObj.name.toLowerCase().replace(' ', ''),\n          width: 15\n        });\n      }\n    });\n    if (headersTemp != undefined) sheet.columns = headersTemp;\n    const headerRow = sheet.getRow(1);\n    headerRow.font = {\n      bold: true,\n      color: {\n        argb: 'FFFFFF'\n      }\n    }; // Texte en gras et blanc\n    headerRow.fill = {\n      type: 'pattern',\n      pattern: 'solid',\n      fgColor: {\n        argb: '0070C0'\n      }\n    };\n  }\n  addRowToWorkSheet(row, sheet) {\n    console.log(row);\n    sheet.addRow(row);\n  }\n  saveWorkBookIntoFile(wb, name) {\n    return _asyncToGenerator(function* () {\n      let buff = yield wb.xlsx.writeBuffer();\n      const blob = new Blob([buff], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      saveAs(blob, name + \" \" + new Date().toLocaleTimeString('fr-FR', {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric'\n      }));\n    })();\n  }\n  writeAllRowValuesFor1DArray(sheet, values, limit) {\n    let length = 0;\n    console.log(\"limit\" + limit);\n    console.log(\"length\" + length);\n    console.log(\"values\" + values.length);\n    values.forEach(rowValue => {\n      let rowOfValues = rowValue.map(el => el.value);\n      this.addRowToWorkSheet(rowOfValues, sheet);\n    });\n    sheet.columns.forEach(column => {\n      column.width = column.header.length < 15 ? 15 : column.header.length;\n      column.eachCell({\n        includeEmpty: true\n      }, cell => {\n        const columnWidth = cell.value ? cell.value.toString().length : 15;\n        column.width = Math.max(column.width, columnWidth);\n      });\n    });\n  }\n  static #_ = this.ɵfac = function ExceljsService_Factory(t) {\n    return new (t || ExceljsService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ExceljsService,\n    factory: ExceljsService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["Workbook","saveAs","ExceljsService","constructor","createWorkBook","name","workbook","creator","created","Date","addWorkSheet","sheet","addWorksheet","pageSetup","paperSize","orientation","properties","tabColor","argb","state","addHeadersToWorkSheet","headers","console","log","headersTemp","forEach","headerObj","push","header","key","toLowerCase","replace","width","undefined","columns","headerRow","getRow","font","bold","color","fill","type","pattern","fgColor","addRowToWorkSheet","row","addRow","saveWorkBookIntoFile","wb","_asyncToGenerator","buff","xlsx","writeBuffer","blob","Blob","toLocaleTimeString","day","month","year","writeAllRowValuesFor1DArray","values","limit","length","rowValue","rowOfValues","map","el","value","column","eachCell","includeEmpty","cell","columnWidth","toString","Math","max","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Mamadou\\Documents\\GitHub\\BroadAppsDeleted\\Bases MSA - Reeses\\src\\app\\exceljs.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {Workbook}  from 'exceljs';\nimport { saveAs } from 'file-saver';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ExceljsService {\n\n  constructor() { }\n  \n  public createWorkBook(name:string):any\n  {\n\t\tconst workbook:any = new Workbook();\n\t\tworkbook.creator = name;\n\t\tworkbook.created = new Date();\n\t\treturn workbook;\n  }\n  \n  public addWorkSheet(name:string,workbook:any):any\n  {\n\t\tconst sheet:any = workbook.addWorksheet(name,{\n\t\tpageSetup:{paperSize: 9, orientation:'landscape'},properties:{tabColor:{argb:'FF005B0'}}});\n\t\tsheet.state = 'visible';\n\t\treturn sheet;\n  }\n  \n  public addHeadersToWorkSheet(sheet:any,headers:any[])\n  {\n\t\tconsole.log(headers);\n\t\tlet headersTemp:any[] =[];\n\t\theaders.forEach((headerObj:any)=> \n\t\t{ \n\t\t\tconsole.log(headerObj);\n\t\t\tconsole.log(typeof headerObj);\n\t\t\tconsole.log(typeof headerObj+\" \"+typeof headerObj == 'string');\n\t\t\tif(typeof headerObj == 'string')\n\t\t\t{\n\t\t\t\theadersTemp.push({ header:headerObj,key: headerObj.toLowerCase().replace(' ',''),width:15 }); \n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\theadersTemp.push({ header:headerObj.name,key: headerObj.name.toLowerCase().replace(' ',''),width:15 }); \n\t\t\t}\n\t\t});\n\t\tif(headersTemp != undefined)\n\t\t\tsheet.columns = headersTemp;\n\t\tconst headerRow = sheet.getRow(1);\n\t\theaderRow.font = { bold: true, color: { argb: 'FFFFFF' } }; // Texte en gras et blanc\n\t\theaderRow.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: '0070C0' } }; \n\t\n  }\n  \n  private addRowToWorkSheet(row:any[],sheet:any)\n  {\n\t\tconsole.log(row);\n\t\tsheet.addRow(row); \n  }\n  \n  public async saveWorkBookIntoFile(wb:any,name:string)\n  {\n\tlet buff = await wb.xlsx.writeBuffer();\n\tconst blob = new Blob([buff], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" });\n\tsaveAs(blob,name+\" \"+(new Date()).toLocaleTimeString('fr-FR',{day:'numeric',month:'long',year:'numeric'}));\n  }\n  \n  public writeAllRowValuesFor1DArray(sheet:any,values:any[],limit:number)\n  {\n\t\tlet length = 0;\n\t\tconsole.log(\"limit\"+limit);console.log(\"length\"+length);console.log(\"values\"+values.length);\n\t\tvalues.forEach((rowValue:any[])=>\n\t\t{\n\t\t\tlet rowOfValues = rowValue.map((el:any)=> el.value);\n\t\t\tthis.addRowToWorkSheet(rowOfValues,sheet);\n\t\t});\n\t\t\n\t\tsheet.columns.forEach((column:any) => {\n\t\t\tcolumn.width = column.header.length < 15 ? 15 : column.header.length;\n\t\t\tcolumn.eachCell({ includeEmpty: true }, (cell:any) => {\n\t\t\t\tconst columnWidth = cell.value ? cell.value.toString().length : 15;\n\t\t\t\tcolumn.width = Math.max(column.width, columnWidth);\n\t\t\t});\n\t\t});\n  }\n  \n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}