{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Mamadou/Documents/GitHub/BroadAppsDeleted/Bases MSA - Reeses/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as ExcelJS from 'exceljs';\nimport { saveAs } from 'file-saver';\nimport * as i0 from \"@angular/core\";\nexport class ExceljsService {\n  constructor() {}\n  createWorkBook(name) {\n    const workbook = new ExcelJS.Workbook();\n    workbook.creator = name;\n    workbook.created = new Date();\n    return workbook;\n  }\n  addWorkSheet(name, workbook) {\n    const sheet = workbook.addWorksheet(name, {\n      pageSetup: {\n        paperSize: 9,\n        orientation: 'landscape'\n      },\n      properties: {\n        tabColor: {\n          argb: 'FF005B0'\n        }\n      }\n    });\n    sheet.state = 'visible';\n    return sheet;\n  }\n  addHeadersToWorkSheet(sheet, headers) {\n    sheet.columns = headers.map(element => {\n      header: element;\n    });\n  }\n  addRowsToWorkSheet(rows, sheet) {\n    rows.forEach(row => {\n      sheet.addRow(row);\n    });\n  }\n  saveWorkBookIntoFile(wb, name) {\n    return _asyncToGenerator(function* () {\n      let buff = yield wb.xlsx.writeBuffer();\n      const blob = new Blob([buff], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      saveAs(blob, name + \" \" + new Date().toLocaleTimeString('fr-FR', {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric'\n      }));\n    })();\n  }\n  writeAllRowValuesFor1DArray(sheet, values, limit) {\n    let length = 0;\n    while (length < limit && limit > 0 && values.length <= limit) {\n      let rowOfValues = [];\n      for (let i = 0; i < limit; ++i) {\n        rowOfValues.push(values[i].value);\n        ++length;\n      }\n      this.addRowsToWorkSheet(rowOfValues, sheet);\n    }\n  }\n  static #_ = this.ɵfac = function ExceljsService_Factory(t) {\n    return new (t || ExceljsService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: ExceljsService,\n    factory: ExceljsService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["ExcelJS","saveAs","ExceljsService","constructor","createWorkBook","name","workbook","Workbook","creator","created","Date","addWorkSheet","sheet","addWorksheet","pageSetup","paperSize","orientation","properties","tabColor","argb","state","addHeadersToWorkSheet","headers","columns","map","element","header","addRowsToWorkSheet","rows","forEach","row","addRow","saveWorkBookIntoFile","wb","_asyncToGenerator","buff","xlsx","writeBuffer","blob","Blob","type","toLocaleTimeString","day","month","year","writeAllRowValuesFor1DArray","values","limit","length","rowOfValues","i","push","value","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Mamadou\\Documents\\GitHub\\BroadAppsDeleted\\Bases MSA - Reeses\\src\\app\\exceljs.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport * as ExcelJS from 'exceljs';\nimport { saveAs } from 'file-saver';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ExceljsService {\n\n  constructor() { }\n  \n  public createWorkBook(name:string):any\n  {\n\t\tconst workbook:any = new ExcelJS.Workbook();\n\t\tworkbook.creator = name;\n\t\tworkbook.created = new Date();\n\t\treturn workbook;\n  }\n  \n  public addWorkSheet(name:string,workbook:any):any\n  {\n\t\tconst sheet:any = workbook.addWorksheet(name,{\n\t\tpageSetup:{paperSize: 9, orientation:'landscape'},properties:{tabColor:{argb:'FF005B0'}}});\n\t\tsheet.state = 'visible';\n\t\treturn sheet;\n  }\n  \n  public addHeadersToWorkSheet(sheet:any,headers:any[])\n  {\n\t\tsheet.columns = headers.map ((element:any)=> {header: element});\n  }\n  \n  private addRowsToWorkSheet(rows:any[],sheet:any)\n  {\n\t\trows.forEach((row)=>\n\t\t{\n\t\t\tsheet.addRow(row); \n\t\t});\n  }\n  \n  public async saveWorkBookIntoFile(wb:any,name:string)\n  {\n\tlet buff = await wb.xlsx.writeBuffer();\n\tconst blob = new Blob([buff], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" });\n\tsaveAs(blob,name+\" \"+(new Date()).toLocaleTimeString('fr-FR',{day:'numeric',month:'long',year:'numeric'}));\n  }\n  \n  public writeAllRowValuesFor1DArray(sheet:any,values:any[],limit:number)\n  {\n\t\tlet length = 0;\n\t\twhile(length < limit && limit > 0 && values.length <= limit)\n\t\t{\n\t\t\tlet rowOfValues = [];\n\t\t\tfor(let i = 0; i < limit; ++i)\n\t\t\t{\n\t\t\t\trowOfValues.push(values[i].value);\n\t\t\t\t++length;\n\t\t\t}\n\t\t\tthis.addRowsToWorkSheet(rowOfValues,sheet);\n\t\t}\n  }\n  \n}\n"],"mappings":";AACA,OAAO,KAAKA,OAAO,MAAM,SAAS;AAClC,SAASC,MAAM,QAAQ,YAAY;;AAKnC,OAAM,MAAOC,cAAc;EAEzBC,YAAA,GAAgB;EAETC,cAAcA,CAACC,IAAW;IAEjC,MAAMC,QAAQ,GAAO,IAAIN,OAAO,CAACO,QAAQ,EAAE;IAC3CD,QAAQ,CAACE,OAAO,GAAGH,IAAI;IACvBC,QAAQ,CAACG,OAAO,GAAG,IAAIC,IAAI,EAAE;IAC7B,OAAOJ,QAAQ;EACf;EAEOK,YAAYA,CAACN,IAAW,EAACC,QAAY;IAE5C,MAAMM,KAAK,GAAON,QAAQ,CAACO,YAAY,CAACR,IAAI,EAAC;MAC7CS,SAAS,EAAC;QAACC,SAAS,EAAE,CAAC;QAAEC,WAAW,EAAC;MAAW,CAAC;MAACC,UAAU,EAAC;QAACC,QAAQ,EAAC;UAACC,IAAI,EAAC;QAAS;MAAC;KAAE,CAAC;IAC1FP,KAAK,CAACQ,KAAK,GAAG,SAAS;IACvB,OAAOR,KAAK;EACZ;EAEOS,qBAAqBA,CAACT,KAAS,EAACU,OAAa;IAEpDV,KAAK,CAACW,OAAO,GAAGD,OAAO,CAACE,GAAG,CAAGC,OAAW,IAAG;MAAEC,MAAM,EAAED,OAAO;IAAA,CAAC,CAAC;EAC/D;EAEQE,kBAAkBA,CAACC,IAAU,EAAChB,KAAS;IAE/CgB,IAAI,CAACC,OAAO,CAAEC,GAAG,IAAG;MAEnBlB,KAAK,CAACmB,MAAM,CAACD,GAAG,CAAC;IAClB,CAAC,CAAC;EACF;EAEaE,oBAAoBA,CAACC,EAAM,EAAC5B,IAAW;IAAA,OAAA6B,iBAAA;MAErD,IAAIC,IAAI,SAASF,EAAE,CAACG,IAAI,CAACC,WAAW,EAAE;MACtC,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACJ,IAAI,CAAC,EAAE;QAAEK,IAAI,EAAE;MAAmE,CAAE,CAAC;MAC5GvC,MAAM,CAACqC,IAAI,EAACjC,IAAI,GAAC,GAAG,GAAE,IAAIK,IAAI,EAAE,CAAE+B,kBAAkB,CAAC,OAAO,EAAC;QAACC,GAAG,EAAC,SAAS;QAACC,KAAK,EAAC,MAAM;QAACC,IAAI,EAAC;MAAS,CAAC,CAAC,CAAC;IAAC;EAC1G;EAEOC,2BAA2BA,CAACjC,KAAS,EAACkC,MAAY,EAACC,KAAY;IAEtE,IAAIC,MAAM,GAAG,CAAC;IACd,OAAMA,MAAM,GAAGD,KAAK,IAAIA,KAAK,GAAG,CAAC,IAAID,MAAM,CAACE,MAAM,IAAID,KAAK,EAC3D;MACC,IAAIE,WAAW,GAAG,EAAE;MACpB,KAAI,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,KAAK,EAAE,EAAEG,CAAC,EAC7B;QACCD,WAAW,CAACE,IAAI,CAACL,MAAM,CAACI,CAAC,CAAC,CAACE,KAAK,CAAC;QACjC,EAAEJ,MAAM;;MAET,IAAI,CAACrB,kBAAkB,CAACsB,WAAW,EAACrC,KAAK,CAAC;;EAE3C;EAAC,QAAAyC,CAAA,G;qBArDUnD,cAAc;EAAA;EAAA,QAAAoD,EAAA,G;WAAdpD,cAAc;IAAAqD,OAAA,EAAdrD,cAAc,CAAAsD,IAAA;IAAAC,UAAA,EAFb;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}